<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>ZEUSVPN</title>
  <style>
    :root{
      --bg:#ffffff;
      --bg2:#f5f6fa;
      --card:#ffffff;
      --line:#e9ecf5;
      --text:#0b1220;
      --muted:#5b6475;

      --a:#6d5bff;      /* Zeus purple */
      --b:#00c2ff;      /* Lightning cyan */

      --ok:#22c55e;
      --bad:#ff3b30;
      --warn:#ffb020;

      --r:20px;
      --shadow: 0 10px 30px rgba(15,23,42,.08);
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family:-apple-system,BlinkMacSystemFont,"SF Pro Display","SF Pro Text",Inter,Arial,sans-serif;
      color:var(--text);
      background: linear-gradient(180deg, var(--bg), var(--bg2));
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
    }

    /* Layout */
    .app{
      min-height:100%;
      padding: env(safe-area-inset-top) 16px calc(92px + env(safe-area-inset-bottom)) 16px;
      max-width: 520px;
      margin: 0 auto;
    }

    .topbar{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      padding: 12px 0 14px 0;
    }
    .brand{
      display:flex;
      align-items:center;
      gap:12px;
    }
    .logo{
      width:44px;height:44px;border-radius:14px;
      background: radial-gradient(120% 120% at 20% 10%, rgba(255,255,255,.95), rgba(255,255,255,.5)),
                  linear-gradient(135deg, rgba(109,91,255,.20), rgba(0,194,255,.15));
      border:1px solid var(--line);
      box-shadow: var(--shadow);
      display:grid;
      place-items:center;
      position:relative;
      overflow:hidden;
    }
    .logo:before{
      content:"";
      position:absolute; inset:-20%;
      background: radial-gradient(circle at 30% 20%, rgba(255,255,255,.70), transparent 55%);
      transform: rotate(8deg);
    }
    .bolt{
      width:20px;height:20px; z-index:1;
      filter: drop-shadow(0 8px 12px rgba(109,91,255,.18));
      background: linear-gradient(135deg, var(--a), var(--b));
      -webkit-mask: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="black" d="M13 2L3 14h7l-1 8 12-14h-7l-1-6z"/></svg>') center / contain no-repeat;
      mask: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="black" d="M13 2L3 14h7l-1 8 12-14h-7l-1-6z"/></svg>') center / contain no-repeat;
    }
    .brand h1{
      margin:0;
      font-size:18px;
      line-height:1.1;
      letter-spacing:.2px;
    }
    .brand p{
      margin:2px 0 0 0;
      color:var(--muted);
      font-size:12.5px;
    }

    .chip{
      padding:10px 12px;
      border:1px solid var(--line);
      background: rgba(255,255,255,.85);
      border-radius: 999px;
      box-shadow: 0 10px 24px rgba(15,23,42,.05);
      display:flex; align-items:center; gap:8px;
      font-size:12.5px;
      color:var(--muted);
      user-select:none;
      white-space:nowrap;
    }
    .chip strong{ color:var(--text); font-weight:900; }

    .section{
      display:none;
      animation: fadeUp .18s ease-out;
    }
    .section.active{ display:block; }

    @keyframes fadeUp{
      from { opacity:0; transform: translateY(6px); }
      to   { opacity:1; transform: translateY(0); }
    }

    /* Cards */
    .card{
      background:var(--card);
      border:1px solid var(--line);
      border-radius:var(--r);
      box-shadow: var(--shadow);
      padding:16px;
    }
    .card + .card{ margin-top:12px; }

    .card-title{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      margin-bottom:10px;
    }
    .card-title h2{
      margin:0;
      font-size:14px;
      letter-spacing:.2px;
    }
    .sub{
      margin:0;
      color:var(--muted);
      font-size:12.5px;
      line-height:1.35;
    }

    /* Pills */
    .pill-row{
      display:flex;
      flex-wrap:wrap;
      gap:10px;
      margin-top:10px;
    }
    .pill{
      border:1px solid var(--line);
      background:#fff;
      color:var(--text);
      border-radius:999px;
      padding:10px 14px;
      font-size:13px;
      font-weight:900;
      cursor:pointer;
      user-select:none;
      transition: transform .12s ease, box-shadow .12s ease, border-color .12s ease, background .12s ease, opacity .12s ease;
    }
    .pill:active{ transform: scale(.985); }
    .pill.active{
      border-color: rgba(109,91,255,.55);
      background: rgba(109,91,255,.10);
      box-shadow: 0 12px 22px rgba(109,91,255,.10);
    }
    .pill.disabled{
      opacity:.45;
      cursor:not-allowed;
      pointer-events:none;
    }

    /* Summary */
    .summary{
      display:grid;
      grid-template-columns: 1fr;
      gap:10px;
      margin-top:10px;
    }
    .row{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      padding:10px 12px;
      border:1px dashed rgba(233,236,245,.9);
      border-radius: 14px;
      background: rgba(245,246,250,.55);
    }
    .row span{ color:var(--muted); font-size:12.5px; }
    .row strong{ font-size:13px; }

    .price{
      font-size:24px;
      font-weight:900;
      letter-spacing:.2px;
      background: linear-gradient(135deg, var(--a), var(--b));
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
    }

    /* Buttons */
    .btn{
      width:100%;
      border:0;
      border-radius:18px;
      height:56px;
      font-weight:900;
      font-size:15px;
      cursor:pointer;
      transition: transform .12s ease, box-shadow .12s ease, filter .12s ease, opacity .12s ease;
      user-select:none;
    }
    .btn:disabled{ opacity:.65; cursor:not-allowed; }
    .btn-primary{
      color:#fff;
      background: linear-gradient(135deg, var(--a), var(--b));
      box-shadow: 0 14px 30px rgba(109,91,255,.22);
    }
    .btn-primary:active{ transform: scale(.985); box-shadow: 0 10px 22px rgba(109,91,255,.16); }

    .btn-ghost{
      background:#fff;
      border:1px solid var(--line);
      color:var(--text);
      box-shadow: 0 12px 24px rgba(15,23,42,.06);
    }
    .btn-ghost:active{ transform: scale(.99); }

    .btn-mini{
      height:44px;
      border-radius:14px;
      font-weight:900;
      font-size:13px;
      padding: 0 14px;
      width:auto;
      display:inline-flex;
      align-items:center;
      justify-content:center;
      gap:8px;
    }

    /* Status badge */
    .badge{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding:8px 10px;
      border-radius: 999px;
      font-size:12.5px;
      font-weight:900;
      border:1px solid var(--line);
      background: #fff;
      white-space:nowrap;
    }
    .badge.ok{
      border-color: rgba(34,197,94,.35);
      background: rgba(34,197,94,.12);
      color: #168a3e;
    }
    .badge.bad{
      border-color: rgba(255,59,48,.35);
      background: rgba(255,59,48,.12);
      color: #c9140c;
    }
    .badge.warn{
      border-color: rgba(255,176,32,.35);
      background: rgba(255,176,32,.12);
      color: #b26a00;
    }
    .dot{
      width:8px;height:8px;border-radius:999px;
      background: currentColor;
      opacity:.9;
    }

    /* Config area */
    .mono{
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono","Courier New", monospace;
      font-size:12.5px;
      line-height:1.35;
      background: rgba(245,246,250,.75);
      border:1px solid var(--line);
      border-radius: 16px;
      padding:12px;
      word-break: break-all;
      overflow:auto;
      max-height: 160px;
    }
    .mono.masked{
      filter: blur(7px);
      user-select:none;
      pointer-events:none;
    }
    .actions{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      margin-top:10px;
    }

    /* Orders list */
    .list{
      display:flex;
      flex-direction:column;
      gap:10px;
      margin-top:10px;
    }
    .item{
      border:1px solid var(--line);
      background:#fff;
      border-radius: 16px;
      padding:12px;
      box-shadow: 0 12px 26px rgba(15,23,42,.06);
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:10px;
    }
    .item h3{
      margin:0;
      font-size:13px;
      letter-spacing:.1px;
    }
    .item p{
      margin:4px 0 0 0;
      color:var(--muted);
      font-size:12.5px;
    }
    .tag{
      padding:6px 10px;
      border-radius:999px;
      border:1px solid var(--line);
      font-size:12px;
      font-weight:900;
      background: rgba(245,246,250,.65);
      color: var(--muted);
      white-space:nowrap;
    }

    /* Instruction slider */
    .slider{
      position:relative;
      overflow:hidden;
      border-radius: var(--r);
      border:1px solid var(--line);
      background:#fff;
      box-shadow: var(--shadow);
    }
    .slides{
      display:flex;
      transition: transform .22s ease;
      will-change: transform;
    }
    .slide{
      min-width:100%;
      padding:16px;
    }
    .steps{
      margin-top:10px;
      display:flex;
      flex-direction:column;
      gap:10px;
    }
    .step{
      display:flex;
      gap:10px;
      align-items:flex-start;
      padding:10px 12px;
      border-radius: 16px;
      border:1px solid var(--line);
      background: rgba(245,246,250,.55);
    }
    .num{
      width:28px;height:28px;border-radius: 10px;
      display:grid; place-items:center;
      font-weight:900;
      color:#fff;
      background: linear-gradient(135deg, var(--a), var(--b));
      box-shadow: 0 10px 22px rgba(109,91,255,.18);
      flex: 0 0 auto;
    }
    .step b{ display:block; font-size:13px; }
    .step span{ display:block; color:var(--muted); font-size:12.5px; margin-top:2px; line-height:1.35; }

    .pager{
      display:flex; align-items:center; justify-content:space-between;
      gap:10px;
      padding:12px;
      border-top:1px solid var(--line);
      background: rgba(245,246,250,.45);
    }
    .dots{ display:flex; gap:8px; }
    .dot2{
      width:8px;height:8px;border-radius:999px;
      background: rgba(91,100,117,.35);
    }
    .dot2.active{
      width:20px;
      background: linear-gradient(135deg, var(--a), var(--b));
    }

    /* Bottom nav */
    .nav{
      position: fixed;
      left:0; right:0; bottom:0;
      padding: 10px 14px calc(10px + env(safe-area-inset-bottom)) 14px;
      background: rgba(255,255,255,.78);
      backdrop-filter: blur(18px);
      -webkit-backdrop-filter: blur(18px);
      border-top: 1px solid var(--line);
      z-index: 20;
    }
    .nav-inner{
      max-width:520px;
      margin:0 auto;
      display:flex;
      gap:10px;
      align-items:center;
      justify-content:space-between;
    }
    .navbtn{
      flex:1;
      border:1px solid var(--line);
      background:#fff;
      border-radius: 18px;
      height:52px;
      box-shadow: 0 12px 26px rgba(15,23,42,.06);
      display:flex;
      align-items:center;
      justify-content:center;
      gap:10px;
      font-weight:900;
      color:var(--muted);
      cursor:pointer;
      user-select:none;
      transition: transform .12s ease, color .12s ease, border-color .12s ease, background .12s ease;
    }
    .navbtn:active{ transform: scale(.988); }
    .navbtn.active{
      color:var(--text);
      border-color: rgba(109,91,255,.35);
      background: rgba(109,91,255,.08);
    }
    .ico{
      width:18px;height:18px;
      background: currentColor;
      opacity:.9;
      -webkit-mask-size: contain;
      -webkit-mask-repeat: no-repeat;
      -webkit-mask-position: center;
      mask-size: contain;
      mask-repeat: no-repeat;
      mask-position: center;
    }
    .ico.home{
      -webkit-mask-image:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="black" d="M12 3l9 8h-3v9h-5v-6H11v6H6v-9H3l9-8z"/></svg>');
      mask-image:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="black" d="M12 3l9 8h-3v9h-5v-6H11v6H6v-9H3l9-8z"/></svg>');
    }
    .ico.user{
      -webkit-mask-image:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="black" d="M12 12a5 5 0 1 0-5-5 5 5 0 0 0 5 5zm0 2c-4.42 0-8 2-8 4.5V21h16v-2.5C20 16 16.42 14 12 14z"/></svg>');
      mask-image:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="black" d="M12 12a5 5 0 1 0-5-5 5 5 0 0 0 5 5zm0 2c-4.42 0-8 2-8 4.5V21h16v-2.5C20 16 16.42 14 12 14z"/></svg>');
    }
    .ico.book{
      -webkit-mask-image:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="black" d="M18 2H8a3 3 0 0 0-3 3v16a1 1 0 0 0 1.45.89A6.9 6.9 0 0 1 9 21h9a3 3 0 0 0 3-3V5a3 3 0 0 0-3-3zm1 16a1 1 0 0 1-1 1H9a8.7 8.7 0 0 0-2 .23V5a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1z"/></svg>');
      mask-image:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="black" d="M18 2H8a3 3 0 0 0-3 3v16a1 1 0 0 0 1.45.89A6.9 6.9 0 0 1 9 21h9a3 3 0 0 0 3-3V5a3 3 0 0 0-3-3zm1 16a1 1 0 0 1-1 1H9a8.7 8.7 0 0 0-2 .23V5a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1z"/></svg>');
    }

    /* Toast */
    .toast{
      position: fixed;
      left: 50%;
      transform: translateX(-50%);
      bottom: calc(100px + env(safe-area-inset-bottom));
      background: rgba(11,18,32,.92);
      color:#fff;
      padding: 10px 12px;
      border-radius: 14px;
      font-weight: 900;
      font-size: 12.5px;
      opacity: 0;
      pointer-events:none;
      transition: opacity .15s ease, transform .15s ease;
      z-index: 50;
      max-width: 90vw;
      text-align:center;
    }
    .toast.show{
      opacity: 1;
      transform: translateX(-50%) translateY(-4px);
    }

    /* Helpers */
    .mt12{ margin-top:12px; }
    .mt10{ margin-top:10px; }
    .mt8{ margin-top:8px; }
    .two{
      display:flex; gap:10px; flex-wrap:wrap;
    }
    .two > *{ flex: 1 1 180px; }
    .hr{
      height:1px;
      background: var(--line);
      margin: 12px 0;
    }
  </style>
</head>
<body>

  <div class="app">

    <div class="topbar">
      <div class="brand">
        <div class="logo"><div class="bolt"></div></div>
        <div>
          <h1>ZEUSVPN</h1>
          <p>–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≤—ã–¥–∞—á–∞ VLESS ‚Ä¢ White iOS UI</p>
        </div>
      </div>

      <div class="chip" title="–¢–≤–æ–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –≤ —Å–∏—Å—Ç–µ–º–µ">
        ID: <strong id="userKeyShort">‚Äî</strong>
      </div>
    </div>

    <!-- HOME -->
    <section id="viewHome" class="section active">
      <div class="card">
        <div class="card-title">
          <h2>–¢–∞—Ä–∏—Ñ</h2>
          <span class="badge" id="planBadge"><span class="dot"></span><span id="planBadgeText">–í—ã–±–µ—Ä–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã</span></span>
        </div>
        <p class="sub">–í—ã–±–∏—Ä–∞–π —Å—Ä–æ–∫ –∏ —á–∏—Å–ª–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤. –û–ø–ª–∞—Ç–∞ –æ—Ç–∫—Ä–æ–µ—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ Telegram (Stars / CryptoBot). –ü–æ—Å–ª–µ –æ–ø–ª–∞—Ç—ã –∫–æ–Ω—Ñ–∏–≥ –ø–æ—è–≤–∏—Ç—Å—è –≤ –∫–∞–±–∏–Ω–µ—Ç–µ.</p>

        <div class="mt12">
          <div class="card-title" style="margin-bottom:6px;">
            <h2 style="font-size:13px;margin:0;">–°—Ä–æ–∫</h2>
            <span class="sub" id="daysHint">30 –¥–Ω–µ–π</span>
          </div>
          <div class="pill-row" id="daysPills"></div>
        </div>

        <div class="mt12">
          <div class="card-title" style="margin-bottom:6px;">
            <h2 style="font-size:13px;margin:0;">–£—Å—Ç—Ä–æ–π—Å—Ç–≤–∞</h2>
            <span class="sub" id="devHint">1 —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ</span>
          </div>
          <div class="pill-row" id="devPills"></div>
        </div>

        <div class="summary">
          <div class="row">
            <span>–ò—Ç–æ–≥–æ</span>
            <strong class="price" id="priceText">‚Äî</strong>
          </div>
          <div class="row">
            <span>–û–ø–ª–∞—Ç–∞</span>
            <strong id="payHint">Telegram Stars / CryptoBot</strong>
          </div>
        </div>

        <div class="mt12">
          <button class="btn btn-primary" id="payBtn">–û–ø–ª–∞—Ç–∏—Ç—å</button>
        </div>

        <p class="sub mt10">
          –≠—Ç–æ –¥–µ–º–æ-—Ñ—Ä–æ–Ω—Ç: ‚Äú–∏–Ω–≤–æ–π—Å‚Äù –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –∫–∞–∫ —Å—Å—ã–ª–∫–∞, –∞ —É—Å–ø–µ—à–Ω–∞—è –æ–ø–ª–∞—Ç–∞ –∏–º–∏—Ç–∏—Ä—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.
          –ö–æ–≥–¥–∞ –ø–æ–¥–∫–ª—é—á–∏–º –±–µ–∫–µ–Ω–¥ ‚Äî —Å—é–¥–∞ –±—É–¥—É—Ç –ø—Ä–∏—Ö–æ–¥–∏—Ç—å —Ä–µ–∞–ª—å–Ω—ã–µ invoice-—Å—Å—ã–ª–∫–∏ –æ—Ç Stars –∏ CryptoBot.
        </p>
      </div>

      <div class="card">
        <div class="card-title">
          <h2>–ü–æ—á–µ–º—É —ç—Ç–æ —É–¥–æ–±–Ω–æ</h2>
          <span class="tag">–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏</span>
        </div>
        <div class="two mt10">
          <div class="row" style="border-style:solid;">
            <span>‚è± –ë–µ–∑ –ø–æ–¥–¥–µ—Ä–∂–∫–∏</span>
            <strong>–≤—ã–¥–∞—á–∞ –∑–∞ —Å–µ–∫—É–Ω–¥—ã</strong>
          </div>
          <div class="row" style="border-style:solid;">
            <span>üîí –†–µ–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–µ—Ä</span>
            <strong>—á–µ—Ä–µ–∑ 3x-ui/Xray</strong>
          </div>
          <div class="row" style="border-style:solid;">
            <span>üßæ –°—Ç–∞—Ç—É—Å</span>
            <strong>‚Äú–ê–∫—Ç–∏–≤–Ω–∞ –¥–æ ‚Ä¶‚Äù</strong>
          </div>
          <div class="row" style="border-style:solid;">
            <span>üì≤ –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è</span>
            <strong>iOS/Android/Desktop</strong>
          </div>
        </div>
      </div>
    </section>

    <!-- PAY -->
    <section id="viewPay" class="section">
      <div class="card">
        <div class="card-title">
          <h2>–û–ø–ª–∞—Ç–∞</h2>
          <span class="tag" id="payOrderId">‚Äî</span>
        </div>

        <div class="summary">
          <div class="row">
            <span>–¢–∞—Ä–∏—Ñ</span>
            <strong id="payPlanText">‚Äî</strong>
          </div>
          <div class="row">
            <span>–°—É–º–º–∞</span>
            <strong class="price" id="payAmountText">‚Äî</strong>
          </div>
        </div>

        <p class="sub mt10">–í—ã–±–µ—Ä–∏ —Å–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã. –ú—ã –æ—Ç–∫—Ä–æ–µ–º –≥–æ—Ç–æ–≤—ã–π –∏–Ω–≤–æ–π—Å –≤–Ω—É—Ç—Ä–∏ Telegram.</p>

        <div class="pill-row" id="payMethodPills"></div>

        <div class="mt12">
          <button class="btn btn-primary" id="openInvoiceBtn">–û—Ç–∫—Ä—ã—Ç—å –æ–ø–ª–∞—Ç—É</button>
        </div>

        <div class="mt10">
          <button class="btn btn-ghost" id="checkStatusBtn">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å</button>
        </div>

        <div class="mt12" id="payStatusBox">
          <span class="badge warn" id="payStatusBadge"><span class="dot"></span><span>–û–∂–∏–¥–∞–µ—Ç –æ–ø–ª–∞—Ç—É</span></span>
          <p class="sub mt10" id="payStatusHint">–ü–æ—Å–ª–µ –æ–ø–ª–∞—Ç—ã —Å—Ç–∞—Ç—É—Å –æ–±–Ω–æ–≤–∏—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.</p>
        </div>

        <div class="mt12" style="display:none" id="paySuccessBox">
          <span class="badge ok"><span class="dot"></span><span>–û–ø–ª–∞—á–µ–Ω–æ ‚úÖ</span></span>
          <p class="sub mt10">–ü–µ—Ä–µ—Ö–æ–¥–∏–º –≤ –∫–∞–±–∏–Ω–µ—Ç‚Ä¶</p>
        </div>

        <div class="mt12" style="display:none" id="payFailBox">
          <span class="badge bad"><span class="dot"></span><span>–ù–µ –æ–ø–ª–∞—á–µ–Ω–æ</span></span>
          <p class="sub mt10">–ï—Å–ª–∏ —Ç—ã —É–∂–µ –æ–ø–ª–∞—Ç–∏–ª ‚Äî –Ω–∞–∂–º–∏ ‚Äú–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å‚Äù.</p>
        </div>

        <div class="mt12">
          <button class="btn btn-ghost" id="backFromPayBtn">–ù–∞–∑–∞–¥ –∫ —Ç–∞—Ä–∏—Ñ–∞–º</button>
        </div>
      </div>

      <div class="card">
        <div class="card-title">
          <h2>–í–∞–∂–Ω–æ</h2>
          <span class="tag">Mini App</span>
        </div>
        <p class="sub">
          –ú—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º –≥–æ—Ç–æ–≤—ã–µ —Ä–µ—à–µ–Ω–∏—è: Telegram Stars –∏ CryptoBot (Crypto Pay). –ù–∞ –ø—Ä–æ–¥–µ –∏–Ω–≤–æ–π—Å –±—É–¥–µ—Ç –æ—Ç–∫—Ä—ã–≤–∞—Ç—å—Å—è —á–µ—Ä–µ–∑ Telegram WebApp API,
          –∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –æ–ø–ª–∞—Ç—ã ‚Äî —á–µ—Ä–µ–∑ –±–µ–∫–µ–Ω–¥ –ø–æ webhook.
        </p>
      </div>
    </section>

    <!-- CABINET -->
    <section id="viewCabinet" class="section">
      <div class="card">
        <div class="card-title">
          <h2>–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç</h2>
          <span class="tag" id="subTag">‚Äî</span>
        </div>

        <div class="two mt10">
          <div class="row" style="border-style:solid;">
            <span>User Key</span>
            <strong class="mono" style="max-height:none;" id="userKeyFull">‚Äî</strong>
          </div>
          <div class="row" style="border-style:solid;">
            <span>–£—Å—Ç—Ä–æ–π—Å—Ç–≤–∞</span>
            <strong id="devicesLimitText">‚Äî</strong>
          </div>
        </div>

        <div class="mt10">
          <div class="row" style="border-style:solid;">
            <span>–ü–æ–¥–ø–∏—Å–∫–∞</span>
            <strong id="activeUntilText">‚Äî</strong>
          </div>
        </div>

        <p class="sub mt10">–ö–æ–Ω—Ñ–∏–≥ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –ø–æ–¥–ø–∏—Å–∫–∞ –∞–∫—Ç–∏–≤–Ω–∞.</p>
      </div>

      <div class="card" id="configCard">
        <div class="card-title">
          <h2>–ú–æ–π –∫–æ–Ω—Ñ–∏–≥ (VLESS)</h2>
          <span class="badge bad" id="configBadge"><span class="dot"></span><span>–ù–µ–¥–æ—Å—Ç—É–ø–Ω–æ</span></span>
        </div>

        <div id="configLocked">
          <p class="sub">–û–ø–ª–∞—Ç–∏ —Ç–∞—Ä–∏—Ñ –Ω–∞ –≥–ª–∞–≤–Ω–æ–π ‚Äî –ø–æ—Å–ª–µ —ç—Ç–æ–≥–æ –∑–¥–µ—Å—å –ø–æ—è–≤–∏—Ç—Å—è —Ç–≤–æ—è VLESS —Å—Å—ã–ª–∫–∞.</p>
          <button class="btn btn-ghost mt12" onclick="go('home')">–í—ã–±—Ä–∞—Ç—å —Ç–∞—Ä–∏—Ñ</button>
        </div>

        <div id="configUnlocked" style="display:none;">
          <div class="mono masked" id="vlessLink">‚Äî</div>
          <div class="actions">
            <button class="btn btn-mini btn-ghost" id="toggleMaskBtn">–ü–æ–∫–∞–∑–∞—Ç—å</button>
            <button class="btn btn-mini btn-primary" id="copyBtn">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
            <button class="btn btn-mini btn-ghost" id="openBtn">–û—Ç–∫—Ä—ã—Ç—å</button>
            <button class="btn btn-mini btn-ghost" id="shareBtn">–ü–æ–¥–µ–ª–∏—Ç—å—Å—è</button>
            <button class="btn btn-mini btn-ghost" id="regenBtn" title="–í –¥–µ–º–æ –ø—Ä–æ—Å—Ç–æ –æ–±–Ω–æ–≤–ª—è–µ—Ç —Å—Å—ã–ª–∫—É">–û–±–Ω–æ–≤–∏—Ç—å</button>
          </div>
          <p class="sub mt10">–ù–µ –¥–µ–ª–∏—Å—å —Å—Å—ã–ª–∫–æ–π. –û–Ω–∞ –¥–∞—ë—Ç –¥–æ—Å—Ç—É–ø –∫ —Ç–≤–æ–µ–π –ø–æ–¥–ø–∏—Å–∫–µ.</p>
        </div>
      </div>

      <div class="card">
        <div class="card-title">
          <h2>–ò—Å—Ç–æ—Ä–∏—è –∑–∞–∫–∞–∑–æ–≤</h2>
          <span class="tag" id="ordersCount">0</span>
        </div>
        <div class="list" id="ordersList"></div>
        <button class="btn btn-ghost mt12" id="resetBtn">–°–±—Ä–æ—Å–∏—Ç—å –¥–µ–º–æ-–¥–∞–Ω–Ω—ã–µ</button>
        <p class="sub mt10">–°–±—Ä–æ—Å —É–¥–∞–ª–∏—Ç –ª–æ–∫–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (localStorage). –ù–∞ –ø—Ä–æ–¥–µ —ç—Ç–æ –±—É–¥–µ—Ç SQLite.</p>
      </div>
    </section>

    <!-- INSTRUCTIONS -->
    <section id="viewGuide" class="section">
      <div class="card" style="padding:0;">
        <div class="card-title" style="padding:16px 16px 0 16px; margin-bottom:10px;">
          <h2>–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è</h2>
          <span class="tag" id="slideTag">iOS</span>
        </div>

        <div class="slider">
          <div class="slides" id="slides">
            <!-- iOS -->
            <div class="slide">
              <p class="sub">–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º –∫–ª–∏–µ–Ω—Ç: V2Box / Streisand / Shadowrocket (–ª—é–±–æ–π VLESS-–∫–ª–∏–µ–Ω—Ç).</p>
              <div class="steps">
                <div class="step">
                  <div class="num">1</div>
                  <div><b>–°–∫–æ–ø–∏—Ä—É–π VLESS —Å—Å—ã–ª–∫—É</b><span>–û—Ç–∫—Ä–æ–π ‚Äú–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç‚Äù ‚Üí ‚Äú–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å‚Äù.</span></div>
                </div>
                <div class="step">
                  <div class="num">2</div>
                  <div><b>–ò–º–ø–æ—Ä—Ç–∏—Ä—É–π –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ</b><span>–í –∫–ª–∏–µ–Ω—Ç–µ –≤—ã–±–µ—Ä–∏ ‚ÄúImport from clipboard‚Äù –∏–ª–∏ ‚ÄúAdd by link‚Äù.</span></div>
                </div>
                <div class="step">
                  <div class="num">3</div>
                  <div><b>–ü–æ–¥–∫–ª—é—á–∏—Å—å</b><span>–ù–∞–∂–º–∏ Connect –∏ —Ä–∞–∑—Ä–µ—à–∏ VPN-–ø—Ä–æ—Ñ–∏–ª—å –≤ iOS.</span></div>
                </div>
              </div>
              <div class="hr"></div>
              <button class="btn btn-primary" onclick="go('cabinet')">–û—Ç–∫—Ä—ã—Ç—å –∫–∞–±–∏–Ω–µ—Ç</button>
            </div>

            <!-- Android -->
            <div class="slide">
              <p class="sub">–ü–æ–¥–æ–π–¥—ë—Ç: v2rayNG / NekoRay (–∏–ª–∏ –¥—Ä—É–≥–æ–π –∫–ª–∏–µ–Ω—Ç —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π VLESS).</p>
              <div class="steps">
                <div class="step">
                  <div class="num">1</div>
                  <div><b>–°–∫–æ–ø–∏—Ä—É–π VLESS —Å—Å—ã–ª–∫—É</b><span>–ö–∞–±–∏–Ω–µ—Ç ‚Üí ‚Äú–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å‚Äù.</span></div>
                </div>
                <div class="step">
                  <div class="num">2</div>
                  <div><b>–ò–º–ø–æ—Ä—Ç –ø–æ —Å—Å—ã–ª–∫–µ</b><span>–í –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏: ‚ÄúImport from clipboard / from link‚Äù.</span></div>
                </div>
                <div class="step">
                  <div class="num">3</div>
                  <div><b>–ü–æ–¥–∫–ª—é—á–∏—Å—å</b><span>–ù–∞–∂–º–∏ Start/Connect –∏ —Ä–∞–∑—Ä–µ—à–∏ VPN.</span></div>
                </div>
              </div>
              <div class="hr"></div>
              <button class="btn btn-ghost" onclick="go('home')">–í–µ—Ä–Ω—É—Ç—å—Å—è –∫ —Ç–∞—Ä–∏—Ñ–∞–º</button>
            </div>

            <!-- Desktop -->
            <div class="slide">
              <p class="sub">–ü–æ–¥–æ–π–¥—ë—Ç: Nekoray / –ª—é–±–æ–π –∫–ª–∏–µ–Ω—Ç VLESS —Å –∏–º–ø–æ—Ä—Ç–æ–º –ø–æ —Å—Å—ã–ª–∫–µ.</p>
              <div class="steps">
                <div class="step">
                  <div class="num">1</div>
                  <div><b>–°–∫–æ–ø–∏—Ä—É–π —Å—Å—ã–ª–∫—É</b><span>–ö–∞–±–∏–Ω–µ—Ç ‚Üí ‚Äú–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å‚Äù.</span></div>
                </div>
                <div class="step">
                  <div class="num">2</div>
                  <div><b>–ò–º–ø–æ—Ä—Ç–∏—Ä—É–π</b><span>–í –∫–ª–∏–µ–Ω—Ç–µ: Import ‚Üí From clipboard/URL.</span></div>
                </div>
                <div class="step">
                  <div class="num">3</div>
                  <div><b>–ü–æ–¥–∫–ª—é—á–∏—Å—å</b><span>–í—ã–±–µ—Ä–∏ –ø—Ä–æ—Ñ–∏–ª—å –∏ –Ω–∞–∂–º–∏ Connect.</span></div>
                </div>
              </div>
              <div class="hr"></div>
              <button class="btn btn-primary" onclick="go('cabinet')">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É</button>
            </div>
          </div>

          <div class="pager">
            <button class="btn btn-mini btn-ghost" id="prevBtn">–ù–∞–∑–∞–¥</button>
            <div class="dots">
              <div class="dot2 active"></div>
              <div class="dot2"></div>
              <div class="dot2"></div>
            </div>
            <button class="btn btn-mini btn-ghost" id="nextBtn">–î–∞–ª–µ–µ</button>
          </div>
        </div>

        <div style="padding:16px;">
          <p class="sub">–ü–æ–¥ –ø—Ä–æ–¥: –¥–æ–±–∞–≤–∏–º —Ä–µ–∞–ª—å–Ω—ã–µ —Å—Å—ã–ª–∫–∏ –Ω–∞ App Store / Google Play –∏ –∞–≤—Ç–æ-–æ—Ç–∫—Ä—ã—Ç–∏–µ –∏–º–ø–æ—Ä—Ç–∞.</p>
        </div>
      </div>
    </section>

  </div>

  <!-- Bottom nav -->
  <div class="nav">
    <div class="nav-inner">
      <button class="navbtn active" id="navHome" onclick="go('home')">
        <span class="ico home"></span>
        –ì–ª–∞–≤–Ω–∞—è
      </button>
      <button class="navbtn" id="navCabinet" onclick="go('cabinet')">
        <span class="ico user"></span>
        –ö–∞–±–∏–Ω–µ—Ç
      </button>
      <button class="navbtn" id="navGuide" onclick="go('guide')">
        <span class="ico book"></span>
        –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è
      </button>
    </div>
  </div>

  <div class="toast" id="toast">–û–∫</div>

  <script>
    /***********************
     * ZEUSVPN ‚Äî Single-file Demo Frontend
     * Payments: Telegram Stars / CryptoBot (invoice links)
     * This is DEMO: "paid" is emulated after opening invoice.
     ************************/

    // ---------- Mock pricing (edit as you want) ----------
    const PRICES_30 = { 1: 199, 3: 349, 5: 399, 10: 599 };
    const MULT = { 30: 1.0, 90: 2.6, 180: 4.8 };
    const DAYS = [30, 90, 180];
    const DEVS = [1, 3, 5, 10];

    // ---------- Storage ----------
    const LS_KEY = "zeusvpn_demo_v2";

    function nowTs(){ return Date.now(); }
    function addDays(ts, days){ return ts + days*24*60*60*1000; }
    function fmtDate(ts){
      if(!ts) return "‚Äî";
      const d = new Date(ts);
      const dd = String(d.getDate()).padStart(2,'0');
      const mm = String(d.getMonth()+1).padStart(2,'0');
      const yy = d.getFullYear();
      return `${dd}.${mm}.${yy}`;
    }

    function uid(len=14){
      const chars="ABCDEFGHJKLMNPQRSTUVWXYZ23456789";
      let out="";
      for(let i=0;i<len;i++) out += chars[(Math.random()*chars.length)|0];
      return out;
    }

    function uuid4(){
      return "xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g, c => {
        const r = (Math.random()*16)|0;
        const v = c === "x" ? r : (r&0x3)|0x8;
        return v.toString(16);
      });
    }

    function loadState(){
      const raw = localStorage.getItem(LS_KEY);
      if(raw){
        try { return JSON.parse(raw); } catch(e){}
      }
      const st = {
        user_key: "Z-" + uid(16),
        sub: { active_until: 0, devices_limit: 0, vless: "" },
        orders: [],
        ui: { days: 30, devices: 1 },
        pay: { current_order_id: null, provider: "stars" }, // stars | cryptobot
        ui_flags: { vless_masked: true }
      };
      saveState(st);
      return st;
    }

    function saveState(st){ localStorage.setItem(LS_KEY, JSON.stringify(st)); }
    let state = loadState();

    function sleep(ms){ return new Promise(res => setTimeout(res, ms)); }

    function calcPrice(days, devices){
      const base = PRICES_30[devices] ?? 199;
      const mult = MULT[days] ?? 1;
      return Math.round(base * mult);
    }

    function subscriptionActive(){
      return state.sub.active_until && state.sub.active_until > nowTs();
    }

    // ---------- Demo VLESS ----------
    function buildDemoVless(userKey, devices){
      const uuid = uuid4();
      const host = "vpn.example.com";
      const port = 443;
      const name = encodeURIComponent(`ZEUSVPN-${userKey.slice(-6)}-${devices}dev`);
      return `vless://${uuid}@${host}:${port}?type=ws&security=tls&sni=${host}&path=%2Fzeus&host=${host}#${name}`;
    }

    // ---------- Mock API ----------
    const mockApi = {
      createOrder: async ({days, devices, provider}) => {
        await sleep(220);
        const price = calcPrice(days, devices);

        // DEMO invoice links (placeholder). On prod: backend returns real invoice link.
        const invoice_link = provider === "stars"
          ? "https://t.me/$invoice/FAKE_STARS_INVOICE"
          : "https://t.me/CryptoBot?start=invoice_FAKE";

        const order = {
          order_id: "ORD-" + uid(10),
          created_at: nowTs(),
          status: "pending_payment",
          provider,
          days,
          devices,
          price,
          invoice_link
        };

        state.orders.unshift(order);
        state.pay.current_order_id = order.order_id;
        state.pay.provider = provider;
        saveState(state);
        return order;
      },

      getOrder: async (order_id) => {
        await sleep(180);
        const o = state.orders.find(x => x.order_id === order_id);
        if(!o) throw new Error("order_not_found");
        return o;
      },

      emulatePaid: async (order_id) => {
        await sleep(1600 + Math.random()*1600);
        const o = state.orders.find(x => x.order_id === order_id);
        if(!o) return;

        // set fulfilled
        o.status = "fulfilled";
        o.paid_at = nowTs();
        o.fulfilled_at = nowTs();

        // extend subscription
        const base = (state.sub.active_until && state.sub.active_until > nowTs())
          ? state.sub.active_until
          : nowTs();

        state.sub.active_until = addDays(base, o.days);
        state.sub.devices_limit = o.devices;
        state.sub.vless = buildDemoVless(state.user_key, o.devices);

        saveState(state);
      },

      regenConfig: async () => {
        await sleep(220);
        state.sub.vless = buildDemoVless(state.user_key, state.sub.devices_limit || state.ui.devices);
        saveState(state);
        return state.sub.vless;
      }
    };

    // ---------- UI helpers ----------
    const $ = (sel) => document.querySelector(sel);

    const el = {
      userKeyShort: $("#userKeyShort"),
      userKeyFull: $("#userKeyFull"),

      daysPills: $("#daysPills"),
      devPills: $("#devPills"),
      daysHint: $("#daysHint"),
      devHint: $("#devHint"),
      priceText: $("#priceText"),
      payBtn: $("#payBtn"),
      planBadge: $("#planBadge"),
      planBadgeText: $("#planBadgeText"),

      subTag: $("#subTag"),
      devicesLimitText: $("#devicesLimitText"),
      activeUntilText: $("#activeUntilText"),

      configLocked: $("#configLocked"),
      configUnlocked: $("#configUnlocked"),
      vlessLink: $("#vlessLink"),
      configBadge: $("#configBadge"),

      ordersList: $("#ordersList"),
      ordersCount: $("#ordersCount"),
      resetBtn: $("#resetBtn"),

      toast: $("#toast"),

      // views
      viewHome: $("#viewHome"),
      viewPay: $("#viewPay"),
      viewCabinet: $("#viewCabinet"),
      viewGuide: $("#viewGuide"),

      // nav
      navHome: $("#navHome"),
      navCabinet: $("#navCabinet"),
      navGuide: $("#navGuide"),

      // slider
      slides: $("#slides"),
      prevBtn: $("#prevBtn"),
      nextBtn: $("#nextBtn"),
      slideTag: $("#slideTag"),
      dots: document.querySelectorAll(".dot2"),

      // config actions
      toggleMaskBtn: $("#toggleMaskBtn"),
      copyBtn: $("#copyBtn"),
      openBtn: $("#openBtn"),
      shareBtn: $("#shareBtn"),
      regenBtn: $("#regenBtn"),

      // pay
      payOrderId: $("#payOrderId"),
      payPlanText: $("#payPlanText"),
      payAmountText: $("#payAmountText"),
      payMethodPills: $("#payMethodPills"),
      openInvoiceBtn: $("#openInvoiceBtn"),
      checkStatusBtn: $("#checkStatusBtn"),
      payStatusBadge: $("#payStatusBadge"),
      payStatusHint: $("#payStatusHint"),
      paySuccessBox: $("#paySuccessBox"),
      payFailBox: $("#payFailBox"),
      backFromPayBtn: $("#backFromPayBtn"),
    };

    function toast(msg){
      el.toast.textContent = msg;
      el.toast.classList.add("show");
      setTimeout(() => el.toast.classList.remove("show"), 1400);
    }

    function renderPills(container, values, activeValue, onPick, format){
      container.innerHTML = "";
      values.forEach(v => {
        const b = document.createElement("button");
        b.className = "pill" + (v === activeValue ? " active" : "");
        b.textContent = format ? format(v) : String(v);
        b.onclick = () => onPick(v);
        container.appendChild(b);
      });
    }

    function setHomeBadge(kind, text){
      el.planBadge.className = "badge" + (kind ? " " + kind : "");
      el.planBadgeText.textContent = text;
      el.planBadge.querySelector(".dot").style.opacity = 0.9;
    }

    function renderHome(){
      el.userKeyShort.textContent = state.user_key.slice(-6);
      el.userKeyFull.textContent = state.user_key;

      renderPills(el.daysPills, DAYS, state.ui.days, (v)=>{
        state.ui.days = v; saveState(state); renderHome();
      }, (v)=> `${v} –¥–Ω–µ–π`);

      renderPills(el.devPills, DEVS, state.ui.devices, (v)=>{
        state.ui.devices = v; saveState(state); renderHome();
      }, (v)=> `${v}`);

      el.daysHint.textContent = `${state.ui.days} –¥–Ω–µ–π`;
      el.devHint.textContent = `${state.ui.devices} ${state.ui.devices === 1 ? "—É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ" : "—É—Å—Ç—Ä–æ–π—Å—Ç–≤"}`;

      const price = calcPrice(state.ui.days, state.ui.devices);
      el.priceText.textContent = price + " ‚ÇΩ";

      if(subscriptionActive()){
        setHomeBadge("ok", "–ü–æ–¥–ø–∏—Å–∫–∞ –∞–∫—Ç–∏–≤–Ω–∞");
      } else {
        setHomeBadge("", "–ì–æ—Ç–æ–≤–æ –∫ –æ–ø–ª–∞—Ç–µ");
      }
    }

    function renderCabinet(){
      el.userKeyShort.textContent = state.user_key.slice(-6);
      el.userKeyFull.textContent = state.user_key;

      const active = subscriptionActive();
      const until = state.sub.active_until ? fmtDate(state.sub.active_until) : "‚Äî";
      el.activeUntilText.textContent = active ? `–ê–∫—Ç–∏–≤–Ω–∞ –¥–æ ${until}` : "–ù–µ –∞–∫—Ç–∏–≤–Ω–∞";
      el.devicesLimitText.textContent = state.sub.devices_limit ? String(state.sub.devices_limit) : "‚Äî";

      el.subTag.textContent = active ? "–ê–∫—Ç–∏–≤–Ω–∞" : "–ù–µ –∞–∫—Ç–∏–≤–Ω–∞";

      if(active && state.sub.vless){
        el.configLocked.style.display = "none";
        el.configUnlocked.style.display = "block";
        el.vlessLink.textContent = state.sub.vless;

        el.configBadge.className = "badge ok";
        el.configBadge.innerHTML = '<span class="dot"></span><span>–î–æ—Å—Ç—É–ø–Ω–æ</span>';

        // mask
        const masked = !!state.ui_flags.vless_masked;
        el.vlessLink.classList.toggle("masked", masked);
        el.toggleMaskBtn.textContent = masked ? "–ü–æ–∫–∞–∑–∞—Ç—å" : "–°–∫—Ä—ã—Ç—å";
      } else {
        el.configLocked.style.display = "block";
        el.configUnlocked.style.display = "none";

        el.configBadge.className = "badge bad";
        el.configBadge.innerHTML = '<span class="dot"></span><span>–ù–µ–¥–æ—Å—Ç—É–ø–Ω–æ</span>';
      }

      el.ordersCount.textContent = String(state.orders.length);
      el.ordersList.innerHTML = "";

      if(state.orders.length === 0){
        const empty = document.createElement("div");
        empty.className = "row";
        empty.innerHTML = `<span>–ü–æ–∫–∞ –Ω–µ—Ç –∑–∞–∫–∞–∑–æ–≤</span><strong style="color:var(--muted)">—Å–æ–∑–¥–∞–π –Ω–∞ –≥–ª–∞–≤–Ω–æ–π</strong>`;
        el.ordersList.appendChild(empty);
      } else {
        state.orders.slice(0, 12).forEach(o => {
          const div = document.createElement("div");
          div.className = "item";
          const statusTxt =
            o.status === "fulfilled" ? "–û–ø–ª–∞—á–µ–Ω–æ" :
            o.status === "pending_payment" ? "–û–∂–∏–¥–∞–µ—Ç –æ–ø–ª–∞—Ç—É" :
            o.status === "failed" ? "–û—à–∏–±–∫–∞" :
            o.status;

          const date = fmtDate(o.created_at);

          const pillStyle =
            o.status === "fulfilled"
              ? "color:#168a3e;background:rgba(34,197,94,.12);border-color:rgba(34,197,94,.35);"
              : o.status === "failed"
              ? "color:#c9140c;background:rgba(255,59,48,.12);border-color:rgba(255,59,48,.35);"
              : "";

          div.innerHTML = `
            <div>
              <h3>${o.days} –¥–Ω–µ–π ‚Ä¢ ${o.devices} —É—Å—Ç—Ä–æ–π—Å—Ç–≤ ‚Ä¢ ${o.price} ‚ÇΩ</h3>
              <p>${o.order_id} ‚Ä¢ ${date} ‚Ä¢ ${o.provider === "stars" ? "Stars" : "CryptoBot"}</p>
            </div>
            <div class="tag" style="${pillStyle}">
              ${statusTxt}
            </div>
          `;
          el.ordersList.appendChild(div);
        });
      }
    }

    // ---------- Pay screen ----------
    function setPayBadge(kind, text){
      el.payStatusBadge.className = "badge " + (kind || "warn");
      el.payStatusBadge.innerHTML = `<span class="dot"></span><span>${text}</span>`;
    }

    function ensureCurrentOrder(){
      const orderId = state.pay.current_order_id;
      if(!orderId) return null;
      return state.orders.find(o => o.order_id === orderId) || null;
    }

    function renderPay(){
      const order = ensureCurrentOrder();
      if(!order){
        toast("–°–Ω–∞—á–∞–ª–∞ —Å–æ–∑–¥–∞–π –∑–∞–∫–∞–∑");
        return go("home");
      }

      el.payOrderId.textContent = order.order_id;
      el.payPlanText.textContent = `${order.days} –¥–Ω–µ–π ‚Ä¢ ${order.devices} —É—Å—Ç—Ä–æ–π—Å—Ç–≤`;
      el.payAmountText.textContent = `${order.price} ‚ÇΩ`;

      const methods = [
        {id:"stars", label:"Telegram Stars"},
        {id:"cryptobot", label:"CryptoBot"}
      ];

      el.payMethodPills.innerHTML = "";
      methods.forEach(m=>{
        const b = document.createElement("button");
        b.className = "pill" + (state.pay.provider === m.id ? " active" : "");
        b.textContent = m.label;
        b.onclick = ()=>{
          state.pay.provider = m.id;
          // In prod: you can create order for selected provider
          // In demo: just store selection
          saveState(state);
          renderPay();
        };
        el.payMethodPills.appendChild(b);
      });

      el.paySuccessBox.style.display = "none";
      el.payFailBox.style.display = "none";

      if(order.status === "fulfilled"){
        setPayBadge("ok","–û–ø–ª–∞—á–µ–Ω–æ ‚úÖ");
        el.paySuccessBox.style.display = "block";
        el.payStatusHint.textContent = "–ü–ª–∞—Ç—ë–∂ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥—ë–Ω. –ö–æ–Ω—Ñ–∏–≥ –≥–æ—Ç–æ–≤.";
      } else if(order.status === "failed" || order.status === "expired"){
        setPayBadge("bad","–û—à–∏–±–∫–∞/–∏—Å—Ç—ë–∫");
        el.payFailBox.style.display = "block";
        el.payStatusHint.textContent = "–ï—Å–ª–∏ –æ–ø–ª–∞—Ç–∏–ª ‚Äî –Ω–∞–∂–º–∏ ‚Äú–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å‚Äù.";
      } else {
        setPayBadge("warn","–û–∂–∏–¥–∞–µ—Ç –æ–ø–ª–∞—Ç—É");
        el.payStatusHint.textContent =
          state.pay.provider === "stars"
            ? "–û—Ç–∫—Ä–æ–µ–º –æ–ø–ª–∞—Ç—É Stars –≤–Ω—É—Ç—Ä–∏ Telegram."
            : "–û—Ç–∫—Ä–æ–µ–º –∏–Ω–≤–æ–π—Å CryptoBot –≤–Ω—É—Ç—Ä–∏ Telegram.";
      }
    }

    async function openInvoiceLink(link){
      // Telegram Mini App supports Telegram.WebApp.openInvoice
      try{
        if(window.Telegram && Telegram.WebApp && typeof Telegram.WebApp.openInvoice === "function"){
          Telegram.WebApp.openInvoice(link, (status) => {
            // status could be 'paid', 'cancelled', 'failed' (depends on provider)
            if(status === "paid") toast("–û–ø–ª–∞—Ç–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞");
          });
          return;
        }
      }catch(e){}
      // fallback
      window.open(link, "_blank");
    }

    let payPollTimer = null;

    async function pollOrder(order_id, maxMs=60000){
      if(payPollTimer) clearInterval(payPollTimer);

      const started = Date.now();
      payPollTimer = setInterval(async ()=>{
        try{
          const o = await mockApi.getOrder(order_id);
          if(o.status === "fulfilled"){
            clearInterval(payPollTimer);
            payPollTimer = null;
            renderPay();
            setTimeout(()=>go("cabinet"), 650);
            return;
          }
          if(Date.now() - started > maxMs){
            clearInterval(payPollTimer);
            payPollTimer = null;
            setPayBadge("warn","–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–∑–∂–µ");
            el.payStatusHint.textContent = "–ü–ª–∞—Ç—ë–∂ –µ—â—ë –Ω–µ –Ω–∞–π–¥–µ–Ω. –ù–∞–∂–º–∏ ‚Äú–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å‚Äù –ø–æ–∑–∂–µ.";
          }
        }catch(e){
          // ignore
        }
      }, 2500);
    }

    // ---------- Navigation ----------
    function setNav(active){
      [el.navHome, el.navCabinet, el.navGuide].forEach(b => b.classList.remove("active"));
      if(active === "home") el.navHome.classList.add("active");
      if(active === "cabinet") el.navCabinet.classList.add("active");
      if(active === "guide") el.navGuide.classList.add("active");
    }

    function go(where){
      // stop poll if leaving pay
      if(where !== "pay" && payPollTimer){
        clearInterval(payPollTimer);
        payPollTimer = null;
      }

      [el.viewHome, el.viewPay, el.viewCabinet, el.viewGuide].forEach(v => v.classList.remove("active"));

      if(where === "home"){
        el.viewHome.classList.add("active");
        setNav("home");
        renderHome();
      }
      if(where === "pay"){
        el.viewPay.classList.add("active");
        // keep nav on home visually (payment is part of purchase flow)
        setNav("home");
        renderPay();
      }
      if(where === "cabinet"){
        el.viewCabinet.classList.add("active");
        setNav("cabinet");
        renderCabinet();
      }
      if(where === "guide"){
        el.viewGuide.classList.add("active");
        setNav("guide");
      }
      window.scrollTo({top:0, behavior:"smooth"});
    }

    // ---------- Home -> create order -> pay screen ----------
    el.payBtn.onclick = async () => {
      const days = state.ui.days;
      const devices = state.ui.devices;
      const provider = state.pay?.provider || "stars";

      el.payBtn.disabled = true;
      el.payBtn.textContent = "–°–æ–∑–¥–∞—ë–º –∑–∞–∫–∞–∑‚Ä¶";

      try{
        await mockApi.createOrder({days, devices, provider});
        el.payBtn.textContent = "–û–ø–ª–∞—Ç–∏—Ç—å";
        el.payBtn.disabled = false;
        go("pay");
      } catch(e){
        console.error(e);
        toast("–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–∫–∞–∑–∞");
        el.payBtn.textContent = "–û–ø–ª–∞—Ç–∏—Ç—å";
        el.payBtn.disabled = false;
      }
    };

    // ---------- Pay actions ----------
    el.openInvoiceBtn.onclick = async () => {
      const order = ensureCurrentOrder();
      if(!order) return;

      // In prod: order is created per provider. For demo: just update provider + link.
      order.provider = state.pay.provider;
      order.invoice_link = order.provider === "stars"
        ? "https://t.me/$invoice/FAKE_STARS_INVOICE"
        : "https://t.me/CryptoBot?start=invoice_FAKE";
      saveState(state);

      setPayBadge("warn","–û–∂–∏–¥–∞–µ–º –æ–ø–ª–∞—Ç—É‚Ä¶");
      el.payStatusHint.textContent = "–û–∫–Ω–æ –æ–ø–ª–∞—Ç—ã –æ—Ç–∫—Ä—ã—Ç–æ. –ü–æ—Å–ª–µ –æ–ø–ª–∞—Ç—ã —Å—Ç–∞—Ç—É—Å –æ–±–Ω–æ–≤–∏—Ç—Å—è.";

      await openInvoiceLink(order.invoice_link);

      // DEMO: emulate paid and poll
      mockApi.emulatePaid(order.order_id);
      pollOrder(order.order_id, 60000);
    };

    el.checkStatusBtn.onclick = async () => {
      const order = ensureCurrentOrder();
      if(!order) return;
      setPayBadge("warn","–ü—Ä–æ–≤–µ—Ä—è–µ–º‚Ä¶");
      pollOrder(order.order_id, 20000);
    };

    el.backFromPayBtn.onclick = () => go("home");

    // ---------- Config actions ----------
    el.toggleMaskBtn?.addEventListener("click", () => {
      state.ui_flags.vless_masked = !state.ui_flags.vless_masked;
      saveState(state);
      renderCabinet();
      toast(state.ui_flags.vless_masked ? "–°–∫—Ä—ã—Ç–æ" : "–ü–æ–∫–∞–∑–∞–Ω–æ");
    });

    el.copyBtn?.addEventListener("click", async () => {
      const text = state.sub.vless || "";
      if(!text) return toast("–ù–µ—Ç —Å—Å—ã–ª–∫–∏");
      try{
        await navigator.clipboard.writeText(text);
        toast("–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ");
      } catch(e){
        const ta = document.createElement("textarea");
        ta.value = text;
        document.body.appendChild(ta);
        ta.select();
        document.execCommand("copy");
        ta.remove();
        toast("–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ");
      }
    });

    el.openBtn?.addEventListener("click", () => {
      const link = state.sub.vless;
      if(!link) return toast("–ù–µ—Ç —Å—Å—ã–ª–∫–∏");
      window.location.href = link;
    });

    el.shareBtn?.addEventListener("click", async () => {
      const link = state.sub.vless;
      if(!link) return toast("–ù–µ—Ç —Å—Å—ã–ª–∫–∏");
      if(navigator.share){
        try{
          await navigator.share({ title: "ZEUSVPN", text: "–ú–æ–π VLESS –∫–æ–Ω—Ñ–∏–≥", url: link });
          toast("–û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ");
        }catch(e){
          toast("–û—Ç–º–µ–Ω–µ–Ω–æ");
        }
      } else {
        toast("Share –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω");
      }
    });

    el.regenBtn?.addEventListener("click", async () => {
      if(!subscriptionActive()) return toast("–ü–æ–¥–ø–∏—Å–∫–∞ –Ω–µ –∞–∫—Ç–∏–≤–Ω–∞");
      el.regenBtn.disabled = true;
      el.regenBtn.textContent = "‚Ä¶";
      try{
        const v = await mockApi.regenConfig();
        el.vlessLink.textContent = v;
        toast("–û–±–Ω–æ–≤–ª–µ–Ω–æ");
      } finally{
        el.regenBtn.disabled = false;
        el.regenBtn.textContent = "–û–±–Ω–æ–≤–∏—Ç—å";
      }
    });

    // ---------- Reset ----------
    el.resetBtn.onclick = () => {
      localStorage.removeItem(LS_KEY);
      state = loadState();
      toast("–î–µ–º–æ-–¥–∞–Ω–Ω—ã–µ —Å–±—Ä–æ—à–µ–Ω—ã");
      renderHome();
      renderCabinet();
      go("home");
    };

    // ---------- Slider ----------
    let slide = 0;
    function setSlide(i){
      slide = Math.max(0, Math.min(2, i));
      el.slides.style.transform = `translateX(-${slide*100}%)`;
      el.dots.forEach((d, idx) => d.classList.toggle("active", idx===slide));
      el.slideTag.textContent = slide === 0 ? "iOS" : slide === 1 ? "Android" : "Desktop";
    }
    el.prevBtn.onclick = () => setSlide(slide-1);
    el.nextBtn.onclick = () => setSlide(slide+1);

    // swipe support
    let sx=0, down=false;
    el.slides.addEventListener("touchstart", (e)=>{ down=true; sx=e.touches[0].clientX; }, {passive:true});
    el.slides.addEventListener("touchend", (e)=>{
      if(!down) return;
      down=false;
      const ex = (e.changedTouches && e.changedTouches[0]) ? e.changedTouches[0].clientX : sx;
      const dx = ex - sx;
      if(Math.abs(dx) > 40){
        if(dx < 0) setSlide(slide+1);
        else setSlide(slide-1);
      }
    }, {passive:true});

    // ---------- First render ----------
    renderHome();
    renderCabinet();
    setSlide(0);

    // expose navigation for inline buttons
    window.go = go;
  </script>
</body>
</html>
