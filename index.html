<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AegisVPN — Получить конфиг</title>
  <style>
    body {font-family:Arial,sans-serif; background:#0d1117; color:#c9d1d9; margin:0; padding:20px; text-align:center;}
    .container {max-width:500px; margin:40px auto; background:#161b22; padding:30px; border-radius:12px; border:1px solid #30363d;}
    h1 {color:#58a6ff;}
    input {width:100%; padding:14px; margin:12px 0; background:#0d1117; color:#c9d1d9; border:1px solid #30363d; border-radius:6px; font-size:16px;}
    button {padding:14px 40px; background:#238636; color:white; border:none; border-radius:6px; font-size:18px; cursor:pointer;}
    button:hover {background:#2ea043;}
    #result {margin-top:30px; padding:20px; background:#0d1117; border:1px solid #30363d; border-radius:8px; word-break:break-all; text-align:left; min-height:120px;}
    .error {color:#f85149;}
    pre {background:#000; padding:12px; border-radius:6px; overflow-x:auto;}
  </style>
</head>
<body>
  <div class="container">
    <h1>AegisVPN</h1>
    <p>Получи конфигурацию на 7 дней</p>

    <input id="name" placeholder="Твоё имя / ник" required>
    <button onclick="getConfig()">Получить конфиг</button>

    <div id="result"></div>
  </div>

  <script>
    async function getConfig() {
      const name = document.getElementById("name").value.trim();
      if (!name) {
        document.getElementById("result").innerHTML = '<span class="error">Введите имя</span>';
        return;
      }

      const result = document.getElementById("result");
      result.innerHTML = "Создаём конфиг...";

      const formData = new FormData();
      formData.append("name", name);

      try {
        const response = await fetch("http://45.133.251.210:8001/get-config", {
          method: "POST",
          body: formData
        });

        const data = await response.json();

        if (data.ok) {
          result.innerHTML = `
            <strong>Готово! (${data.remark})</strong><br><br>
            <pre>${data.link}</pre>
            <br>Действует: ${data.days} дней<br>
            <small>Скопируй и вставь в v2rayN / Nekobox / Hiddify / FoXray</small>
          `;
        } else {
          result.innerHTML = `<span class="error">Ошибка: ${data.error}</span>`;
        }
      } catch (err) {
        result.innerHTML = `<span class="error">Не удалось подключиться к серверу<br>${err.message}</span>`;
      }
    }
  </script>
</body>
</html>
